The Soviet Union's invasion of Afghanistan began a brutal, decade-long guerilla war that killed up to two million Afghans

At his home in the mountains north of Kabul, former mujahideen fighter Shah Sulaiman closed his damaged eyes, took a sip of green tea and thought bitterly of Afghanistan's war against the Soviet Union that started four decades ago.

"When we fought against the Soviets, we were expecting a good future," said the 62-year-old father, who was blinded in one eye and suffered a leg wound when he trod on a landmine during the conflict in 1985.

"Unfortunately things turned out for the worst."

This month marks the 40th anniversary of the Soviet Union's "intervention" -- or invasion -- of Afghanistan, the beginning of a decade-long guerilla war that killed up to two million Afghans, forced seven million more from their homes and led to the deaths of more than 14,000 Soviet troops.

Afghan labourers meltdown the wreckage of Soviet-era machines in an iron factory on the outskirts of western Herat province

"(It) brought only misery and destruction to Afghans and Afghanistan," recalled Sulaiman, who commanded a unit of 12 men in the Panjshir valley, a heartland of mujahideen resistance north of the capital.

In the decades since the war, which ended in 1989, Afghan veterans like Sulaiman and former Soviet soldiers have had to grapple with the physical and emotional wounds of a bloody conflict whose purpose and consequences remain angrily contested.

While the war was a mujahideen victory, what came next saw Afghanistan plunge deeper into misery and fighting, with veterans blaming the conflict for the rise of the Taliban and the ongoing violence that besets the country to this day.

The war 'brought only misery and destruction to Afghans and Afghanistan,' says former mujahideen fighter Shah Sulaiman

In Russia, former Soviet soldiers are still trying to make sense of a war the public condemned at the time and that observers say hastened the collapse of the Soviet Union.

"We defended our southern borders, and I still think our presence in Afghanistan was essential," said Ilias Daoudi, 52, a former Soviet intelligence official who lost a leg in a 1986 landmine blast in Herat, in western Afghanistan.

"A big country like ours has to control what is happening in neighbouring regions."

- 'Right' decision -

Regular Soviet soldiers began arriving in Afghanistan after Moscow's December 24, 1979 deployment order to support a pro-Soviet regime in Kabul and quell a nationalist Islamist insurgency that was pushing back against the atheist communists and their reforms.

'I still think our presence in Afghanistan was essential,' said former Soviet intelligence official Ilias Daoudi

More than 600,000 troops from the USSR would eventually cycle through Afghanistan, playing a part in a Cold War proxy conflict that also saw the United States arm and fund mujahideen fighters including Osama bin Laden.

"It was my religious duty to do Jihad (holy war) against the Soviets because our country was invaded by them and they were spreading communism and infidelity in Afghanistan," Sulaiman said.

In Russia, veterans seek to recast the war as a necessary step to counter the threat of rising Islamism in Afghanistan and Muslim-majority Soviet republics.

The decision to send troops in 1979 was the "right" one -- not just for the communist bloc but on a personal level too, said Vladimir Vchivtsev, 58, who spent 16 months in Afghanistan as a Soviet reconnaissance officer.

The conflict was extremely unpopular with the Soviet public and was officially condemned in 1989 at the height of leader Mikhail Gorbachev's policy of 'glasnost'

"War is the best school of life, where you learn to think quickly and find the best solutions", said Vchivtsev, who was blinded in an explosion in Khost province in 1987.

The conflict was extremely unpopular with the Soviet public at the time and was officially condemned in 1989 at the height of leader Mikhail Gorbachev's policy of "glasnost", or transparency.

But as part of an overall re-evaluation of the war's legacy, Russia's parliamentary defence committee has -- under pressure from veterans -- backed a draft resolution saying Soviet troops helped Afghan authorities fight "terrorist and extremist groups" and curbed the growing security threat facing the USSR.

- Left with 'nothing' -

Sidiqque Rasulzai was a teenager when the Red Army arrived in Kabul, and he had no idea what was coming.

"I didn't know it was war. My parents told me that was something that happened in Palestine, I would never have thought that it could happen to us, that it would last 40 years," recalled Rasulzai, who joined the Soviet-backed Afghan army in 1985 and served for more than three years.

He remembers the Soviets transforming Kabul, constructing apartment buildings with central heating, roads, and even an electric bus system.

"I liked the communists," he said. "They were educated, not like the mujahideen."

To this day, signs of the Soviet war abound. Defunct tanks and abandoned helicopters and personnel carriers still dot parts of the countryside, and in cities such as Kabul and Mazar-i-Sharif, huge Soviet structures still dominate the skyline.

Timeline of key events in Afghanistan since thre Soviet invasion in 1979

After the Soviets left in February 1989, the communist government was unable to sustain itself and civil war broke out. By the mid-1990s, the Taliban -- rooted in the mujahideen movement -- were sweeping to power.

Rasulzai ultimately fled Afghanistan for India in 2015 as the international military presence began to rapidly dwindle.

He worries Afghanistan is headed for a new civil war once the US withdraws under an eventual deal with the Taliban.

Rasulzai now has a small shop in New Delhi and barely manages to pay the bills.

"In Afghanistan, I had everything," he said, "now I have nothing except for security."