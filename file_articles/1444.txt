KARACHI, Pakistan (AP) - Pakistan is heading for a series-clinching victory in the second test against Sri Lanka despite a fighting century on Sunday by Oshada Fernando.

Fernando was 102 not out at stumps on Day 4 but his gritty innings was only likely to delay Pakistan's win. Sri Lanka was 212-7 chasing a daunting victory target of 476.

Pakistan needs just three more wickets on the final day in Karachi to take the two-match series and make a winning return to test action on home soil. The first test was drawn.

This is the first test series in Pakistan for a decade. A 2009 series against Sri Lanka was abandoned after a deadly terrorist gun attack targeted the Sri Lankan team when it was traveling by bus to a game in Lahore. No Sri Lankan players or officials died but policemen and civilians did.

Since then, Pakistan hadn't been allowed to play games at home because of security concerns. But its comeback series looks like it'll be a success.

"Playing at home makes a huge difference, its an advantage," said Pakistan coach Misbah-ul-Haq.

Pakistani players greet Naseem Shah after the dismissal of Sri Lankan batsman during the second Test in Karachi, Pakistan, Sunday, Dec. 22, 2019. Pakistan continued to take the second test away from Sri Lanka with yet another record-making day, reaching 555-3 at lunch on the fourth day and pushing their lead to 475 runs. (AP Photo/Fareed Khan)

"It gives you a completely different energy."

The 16-year-old fast bowler Naseem Shah took 3-31 as Pakistan closed in on its win. Fernando resisted right through to stumps but the one other Sri Lankan batsman to have some success didn't quite make it. Wicketkeeper Niroshan Dickwella was out for 65 three overs from the end of the day.

Earlier, Pakistan's top four batsmen all made centuries in its second innings to put the home team in a dominant position as it declared on 555-3.

Azhar Ali (118) and Babar Azam (100 not out) completed their centuries on Sunday to go with hundreds by openers Abid Ali (174) and Shan Masood (135) on Day 3. Abid now has two centuries in his first two tests.

The feat by Pakistan's top order was only the second time the top four had all made centuries in the same innings in a test. India's Dinesh Karthik, Wasim Jaffer, Rahul Dravid and Sachin Tendulkar did it in 2007 against Bangladesh.

Resuming the day at 395-2, Pakistan put on 160 in just 27 overs - nearly six runs an over - with Azhar and Babar in complete charge.

Azhar's century was the 16th of his career and sixth against Sri Lanka. The captain last scored a hundred over a year ago, a span of 14 innings. His 118 came off 157 balls with 13 boundaries before he was stumped off Lasith Embuldeniya.

Babar, 100 off 131 balls, along with Mohammad Rizwan (21 ) were unbeaten when Pakistan declared.

Pakistan's bowlers kept up the momentum.

They took the first two Sri Lankan wickets in the space of five balls to see the tourists slip to 40-2. Sri Lanka captain Dimuth Karunaratne (16 off 28 balls) edged behind off Mohammad Abbas. Kusal Mendis was out for a duck with a thick edge flying to Babar at third slip off teenager Shah.

The experienced Angelo Mathews fell for 19 to a low catch by wicketkeeper Rizwan that was confirmed by the third umpire.

Dinesh Chandimal (2) and Dhananjaya de Silva (0) went in successive overs after tea.

A 104-run stand between Fernando and Dickwella was broken by spinner Haris Sohail. And Shah got his third wicket right at the end of the day when Dilruwan Perera edged behind for 5.

The first test ended in a draw after more than nine sessions were disrupted by bad weather in Rawalpindi.

___

More AP sports: https://apnews.com/apf-sports and https://twitter.com/AP_Sports

Pakistani batsman Babar Azam acknowledges his 100 against Sri Lanka during the second Test in Karachi, Pakistan, Sunday, Dec. 22, 2019. (AP Photo/Fareed Khan)

Pakistani batsman Babar Azam plays against Sri Lanka during the second Test in Karachi, Pakistan, Sunday, Dec. 22, 2019. (AP Photo/Fareed Khan)

Pakistani batsman Babar Azam hits boundary against Sri Lanka during the second Test in Karachi, Pakistan, Sunday, Dec. 22, 2019. (AP Photo/Fareed Khan)

Pakistani batsman Azhar Ali acknowledges his 100 against Sri Lanka during the second Test in Karachi, Pakistan, Sunday, Dec. 22, 2019. (AP Photo/Fareed Khan)

Pakistani captain Azhar Ali hits a boundary in the third day of the second Test cricket match at National Stadium in Karachi, Pakistan, Saturday, Dec. 21, 2019. Ali (57) and Babar Azam (22) were unbeaten at the close of play, but it was Abid and Shan Masood (135) who stole the show earlier with a huge opening stand of 278. (AP Photo/Fareed Khan)

Pakistani batsman Azhar Ali hits boundary against Sri Lanka during the second Test in Karachi, Pakistan, Sunday, Dec. 22, 2019. (AP Photo/Fareed Khan)

Pakistani batsman Babar Azam greets Azhar Ali for his 100 against Sri Lanka during the second Test in Karachi, Pakistan, Sunday, Dec. 22, 2019. (AP Photo/Fareed Khan)